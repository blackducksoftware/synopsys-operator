$(function(){$("#polaris-options-form").on("submit",function(e){e.preventDefault(),swal({title:"Confirmation",text:"Are you sure you want to proceed?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0},function(){$.ajax({url:"/install",type:"POST",contentType:"application/x-www-form-urlencoded",data:$("#polaris-options-form").serialize(),success:function(e){swal({title:"Success",text:e.responseText,type:"success"},function(){location.href="/complete"})},error:function(e){swal({title:"Failure",text:e.responseText,type:"error"})}})})})}),$(function(){$("#operator-deploy-form").on("submit",function(e){e.preventDefault(),swal({title:"Confirmation",text:"Are you sure you want to proceed?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0},function(){$.ajax({url:"/deploy",type:"POST",contentType:"application/x-www-form-urlencoded",data:$("#operator-deploy-form").serialize(),success:function(e){swal({title:"Success",text:e.responseText,type:"success"},function(){location.href="/operator"})},error:function(e){swal({title:"Failure",text:e.responseText,type:"error"})}})})})}),$(document).on("change","input[type=radio][name=postgresInstanceType]",function(){"external"==this.value?$.ajax({url:"/postgres_form",type:"GET",success:function(e){$("#postgres").html(e).end().appendTo($("#postgres"))},error:function(e){swal({title:"Failure",text:"Unable to fetch postgres form from server.",type:"error"})}}):"internal"==this.value&&$("#postgres").empty()}),$(document).on("change","input[type=radio][name=sslCertsType]",function(){"custom"==this.value?$.ajax({url:"/ssl_form",type:"GET",success:function(e){$("#ssl").html(e).end().appendTo($("#ssl"))},error:function(e){swal({title:"Failure",text:"Unable to fetch ssl form from server.",type:"error"})}}):"self-signed"==this.value&&$("#ssl").empty()}),$(document).on("change","input[type=radio][name=deploymentPlatform]",function(){"on-prem"==this.value?$.ajax({url:"/on_prem_deploy_form",type:"GET",success:function(e){$("#deployOptions").html(e).end().appendTo($("#deployOptions"))},error:function(e){swal({title:"Failure",text:"Unable to fetch on-prem deploy form from server.",type:"error"})}}):"aws"==this.value?$.ajax({url:"/aws_deploy_form",type:"GET",success:function(e){$("#deployOptions").html(e).end().appendTo($("#deployOptions"))},error:function(e){swal({title:"Failure",text:"Unable to fetch aws deploy form from server.",type:"error"})}}):"gcp"==this.value?$.ajax({url:"/gcp_deploy_form",type:"GET",success:function(e){$("#deployOptions").html(e).end().appendTo($("#deployOptions"))},error:function(e){swal({title:"Failure",text:"Unable to fetch gcp deploy form from server.",type:"error"})}}):"azure"==this.value&&$.ajax({url:"/azure_deploy_form",type:"GET",success:function(e){$("#deployOptions").html(e).end().appendTo($("#deployOptions"))},error:function(e){swal({title:"Failure",text:"Unable to fetch gcp deploy form from server.",type:"error"})}})}),$(document).on("click","button[id=smtp-button]",function(){swal({html:!0,title:"Test SMTP Settings",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,text:"<div class='row'>\n                <div class='col-6'>\n                    <label for='smtpSender'>Sender Email</label>\n                    <input type='text' class='form-control' name='smtpSender'\n                        id='smtpSender' placeholder='Please enter sender email' />\n                </div>\n                <div class='col-6'>\n                    <label for='smtpReceiver'>Receiver Email</label>\n                    <input type='text' class='form-control' name='smtpReceiver'\n                        id='smtpReceiver' placeholder='Please enter receiver email' />\n                </div>\n            </div>"},function(){$.ajax({url:"/test_smtp_settings",type:"POST",contentType:"application/x-www-form-urlencoded",data:{smtpHost:$("#smtpHost").val(),smtpPort:$("#smtpPort").val(),smtpUsername:$("#smtpUsername").val(),smtpPassword:$("#smtpPassword").val(),smtpSender:$("#smtpSender").val(),smtpReceiver:$("#smtpReceiver").val()},success:function(e){swal({title:"SMTP settings are Valid",text:e.responseText,type:"success"})},error:function(e){swal({title:"SMTP settings are invalid",text:e.responseText,type:"error"})}})})}),$(document).on("click","a[id=deploy_polaris]",function(){$.ajax({url:"/operator/status",type:"GET",success:function(e){e.isInstalled?location.href="/deploy_polaris":swal({title:"Warning",text:"Synopsys Operator is not deployed. Redirecting to installtion page. !",type:"info"},function(){location.href="/operator"})},error:function(e){swal({title:"Failure",text:"Unable to operator status from server.",type:"error"})}})})
